/* ========== Design Tokens ========== */
:root{
  --bg:#0b0f1a;
  --card:#121828;
  --muted:#8a94a7;
  --text:#e9eef7;
  --accent:#ff7a00;
  --accent-2:#19c37d;
  --border:#1e293b;

  /* Breakpoints */
  --bp-mobile: 600px;     /* <600 = Phone */
  --bp-tablet: 1024px;    /* 600–1023 = Tablet */
  /* >=1024 = Desktop */
}

/* ========== Base ========== */
*{box-sizing:border-box}
html{scroll-behavior:smooth;}
body{
  margin:0;
  background:var(--bg);
  color:var(--text);
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
  line-height:1.55;
}
.container{width:min(1100px,100%);margin:0 auto;padding:16px}

/* ========== Navigation ========== */
.nav{
  display:flex; gap:10px; flex-wrap:wrap;
  padding:12px 16px; border-bottom:1px solid var(--border);
  position:sticky; top:0; background:var(--bg); z-index:10;
}
.nav a{
  color:var(--muted); text-decoration:none; padding:10px 12px;
  border-radius:10px; font-weight:600;
}
.nav a.active,.nav a:hover{color:#111;background:var(--accent)}

/* Mobile: Nav dichter & ggf. scrollbar */
@media (max-width: calc(var(--bp-mobile) - 1px)){
  .nav{gap:8px; padding:10px 12px; overflow-x:auto}
  .nav a{padding:8px 10px; white-space:nowrap}
}

/* ========== Cards & Buttons ========== */
.card{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:16px;
  padding:16px;
  margin:12px 0;
}
.btn{
  display:inline-flex; gap:8px; align-items:center; justify-content:center;
  padding:12px 16px; border-radius:12px; border:1px solid var(--border);
  color:var(--text); text-decoration:none; min-height:44px;
  font-size:1rem; line-height:1.2; background:#1a2336; cursor:pointer;
}
.btn:hover{filter:brightness(1.06)}
.btn:focus-visible{outline:3px solid #7fb3ff; outline-offset:2px}
.btn.primary{background:var(--accent); color:#111; border-color:transparent}
.btn.dynamic.ok{background:var(--accent-2); color:#0b0f1a; border-color:transparent}
.btn.dynamic.warn{background:#ffb84d; color:#111; border-color:transparent}
.btn.dynamic.critical{background:#ff5c5c; color:#111; border-color:transparent}
.btn-row{display:flex; gap:10px; flex-wrap:wrap}
.btn-row .btn{flex:1 1 180px}

/* Buttons/Typo fein abgestuft je Breakpoint */
@media (max-width: calc(var(--bp-mobile) - 1px)){
  .btn{min-height:48px; font-size:1.05rem}
}
@media (min-width: var(--bp-tablet)){
  .btn{min-height:42px; font-size:.98rem}
}

/* ========== Headings ========== */
h1{margin:.4em 0; font-size: clamp(20px, 4.5vw, 28px)}
h2{margin:.4em 0; font-size: clamp(18px, 3.5vw, 22px)}

/* ========== Timer Layout (responsive) ========== */
.grid-2{
  display:grid; gap:12px;
  grid-template-columns: 1fr;           /* Phone: untereinander */
}
@media (min-width: var(--bp-mobile)){
  .grid-2{ grid-template-columns: 1fr 1fr } /* Tablet: 2-spaltig */
}
@media (min-width: var(--bp-tablet)){
  .grid-2{ gap:16px }                    /* Desktop: mehr Luft */
}

.time{font-size:clamp(30px, 7.5vw, 44px); font-weight:800}
.meta{opacity:.8; margin:6px 0}
.badge{
  display:inline-block; padding:6px 12px; border-radius:999px;
  font-weight:700; font-size:.9rem; margin-bottom:8px;
}
.badge.ok{background:var(--accent-2); color:#0b0f1a}
.badge.warn{background:#ffb84d; color:#111}
.badge.critical{background:#ff5c5c; color:#111; animation:pulse 1s infinite}
.badge.muted{color:var(--muted); border:1px solid var(--border); background:transparent}
@keyframes pulse{0%{transform:scale(1)}50%{transform:scale(1.05)}100%{transform:scale(1)}}

.progress{
  position:relative; height:12px; background:#0f1524;
  border:1px solid var(--border); border-radius:999px; overflow:hidden; margin-top:8px;
}
.progress>span{display:block; height:100%; background:var(--accent); transition:width .4s ease}
.progress.warn>span{background:#ffb84d}
.progress.critical>span{background:#ff5c5c}
.progress.ok>span{background:var(--accent-2)}

/* ========== Map Layout (mit einklappbarem Panel) ========== */
.map-layout{
  display:grid; gap:12px;
  grid-template-columns: 1fr;           /* Phone: Panel unter der Karte (oder eingeklappt) */
}
.map-view{min-height:420px}
.leaflet-container-custom{
  height:100%; min-height:420px; border:1px solid var(--border);
  border-radius:12px; overflow:hidden;
}

/* Tablet: 2 Spalten (Karte + Panel) */
@media (min-width: var(--bp-mobile)) and (max-width: calc(var(--bp-tablet) - 1px)){
  .map-layout{ grid-template-columns: 3fr 2fr }
}
/* Desktop: 2 Spalten (breiter) */
@media (min-width: var(--bp-tablet)){
  .map-layout{ grid-template-columns: 2fr 1fr }
}

.map-panel{
  background:var(--card); border:1px solid var(--border);
  border-radius:12px; padding:12px; max-height:600px; overflow:auto;
}
.panel-toggle{
  display:none;
  margin:8px 0 12px 0;
}
/* Phone: Toggle sichtbar, Panel standardmäßig eingeklappt (über JS gesteuert) */
@media (max-width: calc(var(--bp-mobile) - 1px)){
  .panel-toggle{ display:block }
}

.poi-list{list-style:none; margin:0; padding:0}
.poi-list li{border-bottom:1px dashed var(--border); padding:8px 0}
.poi-head{display:flex; align-items:center; justify-content:space-between}
.poi-meta{color:var(--muted)}
.poi-geo{
  font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  opacity:.7
}

/* Dienst-Klassen */
.hidden{display:none !important}

/* ===== Log/History – Tabelle responsiv ===== */
.log-head{display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap;margin-bottom:8px}
.log-filters{display:flex;gap:8px;flex-wrap:wrap}

.table{width:100%;border:1px solid var(--border);border-radius:12px;overflow:hidden;background:#0f1524}
.table-head,.table-row{
  display:grid;grid-template-columns:140px 1fr 1fr 120px;gap:8px;align-items:center;
}
.table-head{
  background:#121a2a;color:var(--muted);font-weight:700;padding:10px 12px;border-bottom:1px solid var(--border)
}
.table-row{padding:10px 12px;border-bottom:1px solid var(--border)}
.table-row:last-child{border-bottom:none}
.table-empty{padding:16px;color:var(--muted)}

.col-mode{display:flex;align-items:center;gap:8px}
.col-dt{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.col-dur{font-weight:700}

/* Chips/Batches für Modus */
.chip{
  display:inline-block;padding:6px 10px;border-radius:999px;font-weight:700;font-size:.85rem;border:1px solid var(--border)
}
.chip-drive{background:var(--accent);color:#111;border:0}
.chip-break{background:#ffb84d;color:#111;border:0}

/* Mobile: untereinander stapeln */
@media (max-width: 600px){
  .table-head{display:none}
  .table-row{
    grid-template-columns:1fr; gap:6px;
    border-bottom:1px solid var(--border);
    padding:12px;
  }
  .col-mode{order:1}
  .col-dt:nth-of-type(2){order:2}
  .col-dt:nth-of-type(3){order:3}
  .col-dur{order:4}
}
/* ====== Shell & Topbar ====== */
.topbar{position:sticky; top:0; z-index:20; background:var(--bg); border-bottom:1px solid var(--border)}
.topbar-inner{display:flex; align-items:center; justify-content:space-between; padding:10px 0}
.brand{display:flex; align-items:center; gap:10px; font-weight:800; color:var(--text)}
.brand img{display:block; border-radius:6px}
.nav-top{display:none; gap:8px}
.nav-top a{color:var(--muted); text-decoration:none; padding:10px 12px; border-radius:10px; font-weight:600}
.nav-top a.active, .nav-top a:hover{color:#111; background:var(--accent)}
@media (min-width: 1024px){
  .nav-top{display:flex}
}

/* ====== Bottom Tab Bar (Smartphones) ====== */
.nav-bottom{
  position:sticky; bottom:0; z-index:30;
  display:grid; grid-template-columns:repeat(4,1fr);
  background:rgba(10,14,23,.9); backdrop-filter:saturate(1.2) blur(8px);
  border-top:1px solid var(--border);
  padding-bottom:env(safe-area-inset-bottom, 0);
}
.nav-bottom a{
  display:flex; flex-direction:column; align-items:center; justify-content:center;
  gap:4px; padding:10px 6px; text-decoration:none; color:var(--muted); font-weight:700; min-height:56px;
}
.nav-bottom .icon{font-size:20px; line-height:1}
.nav-bottom .label{font-size:.8rem}
.nav-bottom a.active{ color:#111; background:var(--accent) }

/* Tablet/Desktop: Bottom-Nav ausblenden */
@media (min-width: 600px){
  .nav-bottom{ display:none }
}

/* Main spacing so content doesn't hide behind bottom bar on phones */
@media (max-width: 599px){
  .main-content{ padding-bottom: 76px } /* Platz für Bottom-Nav */
}

/* ====== Buttons/Typo (ergonomischer) ====== */
.btn{ min-height: 48px; font-size:1.05rem }
@media (min-width:1024px){ .btn{ min-height:42px; font-size:1rem } }

/* ====== Fokus/Accessiblity sichtbar ====== */
:focus-visible{ outline: 3px solid #7fb3ff; outline-offset: 2px }

/* ====== Kontrast-Check Hinweise (optional, nicht sichtbar) ====== */
/* Alle Primäraktionen haben #ff7a00 auf dunklem Hintergrund → Kontrast > 7:1 (AA/AAA für normal text) */

/* --- Toast & Live Region --- */
.toast{
  position:fixed; left:50%; transform:translateX(-50%);
  bottom: max(20px, env(safe-area-inset-bottom, 0));
  background:var(--accent); color:#111; padding:12px 16px; border-radius:12px;
  box-shadow:0 6px 18px rgba(0,0,0,.35); font-weight:800; z-index:9999
}
.sr-live{ position:absolute; left:-9999px; width:1px; height:1px; overflow:hidden }

/* --- Buttons: aktive Zustände + große Touchflächen --- */
.btn:active{ transform: translateY(0.5px) }
.btn.primary, .btn.dynamic.ok, .btn.dynamic.warn, .btn.dynamic.critical{
  box-shadow: 0 6px 18px rgba(0,0,0,.25), 0 0 0 0 rgba(255,122,0,0);
  transition: box-shadow .2s ease, transform .06s ease;
}
.btn.primary:active, .btn.dynamic.ok:active, .btn.dynamic.warn:active, .btn.dynamic.critical:active{
  box-shadow: 0 4px 12px rgba(0,0,0,.25), 0 0 0 6px rgba(255,122,0,.15);
}

/* --- Reduce Motion: weniger Animationen --- */
@media (prefers-reduced-motion: reduce){
  .badge.critical{ animation: none }
  .btn, .progress>span{ transition: none }
}

/* --- Very Small Phones: Bottom-Nav Labels ausblenden --- */
@media (max-width: 360px){
  .nav-bottom .label{ display:none }
}

/* --- Safe Areas (Notch) --- */
.app-shell{ padding-bottom: env(safe-area-inset-bottom, 0) }
.topbar{ padding-top: env(safe-area-inset-top, 0) }

/* ===== Documents ===== */
.docs-upload{display:grid;grid-template-columns:1fr;gap:10px}
.docs-upload input[type="file"]{display:none}
.input,.select{
  background:#0f1524; border:1px solid var(--border); border-radius:10px;
  color:var(--text); padding:10px 12px; font-size:1rem; min-height:42px;
}
.docs-filter{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
.docs-grid{display:grid;grid-template-columns:1fr;gap:12px}
@media (min-width:600px){ .docs-grid{grid-template-columns:1fr 1fr} }
@media (min-width:1024px){ .docs-grid{grid-template-columns:1fr 1fr 1fr} }

.doc-card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:12px;display:flex;flex-direction:column;gap:10px}
.doc-thumb{height:160px;border:1px solid var(--border);border-radius:10px;overflow:hidden;background:#0f1524;display:flex;align-items:center;justify-content:center;cursor:pointer}
.doc-thumb img{width:100%;height:100%;object-fit:cover}
.doc-pdf,.doc-file{font-weight:900;letter-spacing:.1em;opacity:.9}
.doc-meta{display:flex;flex-direction:column;gap:4px}
.doc-name{font-weight:700;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.doc-sub{color:var(--muted);font-size:.9rem}
.doc-note{background:#1a2336;border:1px solid var(--border);border-radius:8px;padding:6px 8px}

.modal{position:fixed;inset:0;background:rgba(0,0,0,.6);display:flex;align-items:center;justify-content:center;z-index:50}
.modal-body{background:var(--card);border:1px solid var(--border);border-radius:12px;max-width:960px;width:92%;padding:12px}
.modal-head{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
.modal-content{max-height:78vh;overflow:auto;background:#0b0f1a;border-radius:8px;padding:8px}
.muted{color:var(--muted)}

/* Preview: nie über den Viewport hinaus, immer 'contain' */
.modal{position:fixed;inset:0;background:rgba(0,0,0,.6);display:flex;align-items:center;justify-content:center;z-index:50}
.modal-body{background:var(--card);border:1px solid var(--border);border-radius:12px;max-width:960px;width:92%;padding:12px}
.modal-head{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
.modal-content{max-height:78vh;overflow:auto;background:#0b0f1a;border-radius:8px;padding:8px}
.modal-content.center{display:flex;align-items:center;justify-content:center}
.preview-media{
  max-width:100%;
  max-height:72vh;
  width:auto;
  height:auto;
  object-fit:contain;     /* wichtig gegen „Zoom“ */
  display:block;
  background:#000;        /* optional für Kontrast */
}
.preview-frame{
  width:100%;
  height:72vh;
  border:0;
  background:#fff;        /* PDFs auf hellem Grund */
}

/* --- Ordner-Chips & kleine Verwaltung --- */
.folders-inline{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
.folder-chip{
  display:inline-flex;gap:6px;align-items:center;
  background:#0f1524;border:1px solid var(--border);color:var(--text);
  padding:6px 10px;border-radius:999px;font-weight:700
}
.folder-chip .chip-btn{
  background:transparent;border:0;color:var(--muted);cursor:pointer;
  padding:0; margin-left:4px
}
.folder-chip .chip-btn:hover{ color:var(--text) }

/* --- Zoom-Toolbar im Modal --- */
.zoombar{display:flex;gap:8px;flex-wrap:wrap}
.preview-media{
  max-width:100%; max-height:72vh; object-fit:contain; display:block; background:#000
}
.preview-media.fit{ transform:none !important }
.preview-frame{ width:100%; height:72vh; border:0; background:#fff }

/* --- Upload-UI Ergänzung (Ordnerauswahl) --- */
.docs-upload{display:grid;grid-template-columns:1fr;gap:10px}
@media (min-width:600px){ .docs-upload{grid-template-columns:1fr 1fr 1fr} }

/* ---- Folder Tree ---- */
.tree{ background: var(--card); border: 1px solid var(--border); border-radius: 10px; padding: 6px; max-height: 60vh; overflow:auto; }
.tree-ul{ list-style:none; margin:0; padding-left:0; }
.tree-row{ display:flex; align-items:center; gap:6px; padding:4px 6px; border-radius:8px; }
.tree-row.sel{ background:#0b1228; border:1px solid var(--border); }
.tree-row.drop{ outline:2px dashed var(--accent-2); }
.tree-toggle{ border:none; background:transparent; color:var(--text); cursor:pointer; padding:0 4px; }
.tree-spacer{ display:inline-block; width:14px; }
.tree-name{ user-select:none; }

/* ---- Dropzone für Upload ---- */
.dropzone{ transition: background .15s ease, outline-color .15s ease; }
.dropzone.over{ outline:2px dashed var(--accent); outline-offset:6px; background: rgba(255,122,0,0.06); }

/* Layout */
.docs-layout {
  display: grid;
  grid-template-columns: 320px 1fr;
  gap: 16px;
}

.sidebar .sidebar-head { display: flex; justify-content: space-between; align-items: center; }
.sidebar .sidebar-actions { display: grid; gap: 8px; }
.main-head { display:flex; justify-content:space-between; align-items:center; gap:16px; }
.main-head .path { font-weight: 600; opacity: .9; }
.main-head .filters { display:flex; align-items:center; gap:8px; }

.uploadbar {
  margin-top: 8px;
  display: grid;
  grid-template-columns: 1fr auto;
  gap: 12px;
  align-items: end;
}
.upload-left { display:flex; align-items:center; gap:10px; }
.upload-left .hint { opacity:.8; font-size:.95em; }

.toolbar {
  margin-top: 10px;
  display:flex; align-items:center; gap:8px;
}
.toolbar .spacer { flex:1; }

.grid-files {
  margin-top: 14px;
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
  gap: 12px;
}

.file {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 10px;
  display: grid;
  grid-template-rows: auto auto auto;
  gap: 6px;
}
.file.sel { outline: 2px solid var(--primary); }
.file .thumb {
  background: #0b1228;
  border-radius: 10px;
  height: 140px;
  display: grid; place-items: center;
  overflow: hidden;
}
.file .thumb img { width: 100%; height: 100%; object-fit: cover; }
.file .thumb .icon { font-size: 48px; opacity: .8; }
.file .meta .name { display:flex; align-items:center; gap:8px; }
.file .meta .name strong { overflow:hidden; text-overflow:ellipsis; white-space:nowrap; display:block; }
.file .meta .sub { opacity: .8; display:flex; gap:6px; }

.file .actions { display:flex; flex-wrap: wrap; gap:6px; }
.btn.sm { padding: 4px 8px; font-size: .9em; }
.empty { opacity:.7; text-align:center; padding: 20px; }

/* Tree */
.tree{ background: var(--card); border: 1px solid var(--border); border-radius: 10px; padding: 6px; max-height: 60vh; overflow:auto; }
.tree-ul{ list-style:none; margin:0; padding-left:0; }
.tree-row{ display:flex; align-items:center; gap:6px; padding:4px 6px; border-radius:8px; }
.tree-row.sel{ background:#0b1228; border:1px solid var(--border); }
.tree-row.drop{ outline:2px dashed var(--primary); }
.tree-toggle{ border:none; background:transparent; color:var(--fg); cursor:pointer; padding:0 4px; }
.tree-spacer{ display:inline-block; width:14px; }
.tree-name{ user-select:none; }

/* Dropzone */
.dropzone{ transition: background .15s ease, outline-color .15s ease; }
.dropzone.over{ outline:2px dashed var(--primary); outline-offset:6px; background: rgba(239,68,68,0.06); }

/* Toast */
.toast {
  position: sticky; top: -8px; margin-bottom: 8px;
  background: #123; border: 1px solid var(--border); border-radius: 8px;
  padding: 8px 10px; font-weight: 600;
}

/* Modal backdrop (falls nicht vorhanden) */
.modal-backdrop {
  position: fixed; inset: 0; background: rgba(0,0,0,.4);
  display: grid; place-items: center;
}
.modal { background: var(--card); border:1px solid var(--border); border-radius:12px; max-width: min(92vw, 1024px); width: 100%; }
.modal .toolbar { padding:10px; border-bottom:1px solid var(--border); display:flex; gap:8px; align-items:center; }
.modal .content { padding:0; }

/* util */
.screen-reader { position:absolute; left:-9999px; top:auto; width:1px; height:1px; overflow:hidden; }

/* Layout */
.docs-layout {
  display: grid;
  grid-template-columns: 320px 1fr;
  gap: 16px;
}

.sidebar .sidebar-head { display: flex; justify-content: space-between; align-items: center; }
.sidebar .sidebar-actions { display: grid; gap: 8px; }

.main { position: relative; }
.main-head { display:flex; justify-content:space-between; align-items:center; gap:16px; }
.main-head .path { font-weight: 600; opacity: .9; }
.main-head .filters { display:flex; align-items:center; gap:8px; }

.uploadbar {
  margin-top: 8px;
  display: grid;
  grid-template-columns: 1fr auto;
  gap: 12px;
  align-items: end;
}
.upload-left { display:flex; align-items:center; gap:10px; }
.upload-left .hint { opacity:.8; font-size:.95em; }

/* Dropzone (groß + dezent) */
.dropzone{ transition: background .15s ease, outline-color .15s ease; min-height: 160px; }
.dropzone.over{ outline:2px dashed var(--primary); outline-offset:6px; background: rgba(239,68,68,0.06); }

.toolbar {
  margin-top: 10px;
  display:flex; align-items:center; gap:8px;
}
.toolbar .spacer { flex:1; }

.grid-files {
  margin-top: 14px;
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
  gap: 12px;
}

.file {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 10px;
  display: grid;
  grid-template-rows: auto auto auto;
  gap: 6px;
  box-shadow: 0 1px 0 rgba(0,0,0,.15);
}
.file.sel { outline: 2px solid var(--primary); }
.file .thumb {
  background: #0b1228;
  border-radius: 10px;
  height: 140px;
  display: grid; place-items: center;
  overflow: hidden;
}
.file .thumb img { width: 100%; height: 100%; object-fit: cover; }
.file .thumb .icon { font-size: 48px; opacity: .8; }
.file .meta .name { display:flex; align-items:center; gap:8px; }
.file .meta .name strong { overflow:hidden; text-overflow:ellipsis; white-space:nowrap; display:block; }
.file .meta .sub { opacity: .8; display:flex; gap:6px; flex-wrap: wrap; }
.file .actions { display:flex; flex-wrap: wrap; gap:6px; }
.btn.sm { padding: 4px 8px; font-size: .9em; }
.empty { opacity:.7; text-align:center; padding: 20px; }

/* Tree */
.tree{ background: var(--card); border: 1px solid var(--border); border-radius: 10px; padding: 6px; max-height: 60vh; overflow:auto; }
.tree-ul{ list-style:none; margin:0; padding-left:0; }
.tree-row{ display:flex; align-items:center; gap:6px; padding:4px 6px; border-radius:8px; }
.tree-row.sel{ background:#0b1228; border:1px solid var(--border); }
.tree-row.drop{ outline:2px dashed var(--primary); }
.tree-toggle{ border:none; background:transparent; color:var(--fg); cursor:pointer; padding:0 4px; }
.tree-spacer{ display:inline-block; width:14px; }
.tree-name{ user-select:none; }

/* Toast */
.toast {
  position: sticky; top: -8px; margin-bottom: 8px;
  background: #123; border: 1px solid var(--border); border-radius: 8px;
  padding: 8px 10px; font-weight: 600;
}

/* Modal Viewer */
.modal-backdrop {
  position: fixed; inset: 0; background: rgba(0,0,0,.4);
  display: grid; place-items: center;
  z-index: 50;
}
.modal.viewer { background: var(--card); border:1px solid var(--border); border-radius:12px; max-width: min(92vw, 1024px); width: 100%; overflow: hidden; }
.modal.viewer .toolbar { padding:10px; border-bottom:1px solid var(--border); display:flex; gap:8px; align-items:center; }
.modal.viewer .content.viewbox { padding:0; background: #0b1020; }
.image-center { display:grid; place-items:center; padding: 8px; }

/* util */
.screen-reader { position:absolute; left:-9999px; top:auto; width:1px; height:1px; overflow:hidden; }


/* ===== Modernisierte Docs UI (Update) ===== */

/* View toggle */
.view-toggle{ display:flex; border:1px solid var(--border); border-radius:10px; overflow:hidden; }
.view-toggle .seg{
  padding:6px 10px; background:transparent; border:none; cursor:pointer;
}
.view-toggle .seg.active{ background: rgba(255,255,255,.06); font-weight: 700; }

/* Grid fixes */
.grid-files { margin-top: 12px; display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 12px; padding: 6px; }
.file { border: 1px solid var(--border); border-radius: 12px; padding: 10px; display: grid; grid-template-rows: auto auto auto; gap: 8px; background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.05)); overflow: hidden; }
.file.sel { outline: 2px solid var(--primary); outline-offset: 0; }
.file .thumb { background: #0b1228; border-radius: 10px; aspect-ratio: 4 / 3; height: auto; display: grid; place-items: center; overflow: hidden; }
.file .thumb img { width: 100%; height: 100%; object-fit: contain; } /* <-- contain: kein Überlaufen bei breiten Bildern */
.file .thumb .icon { font-size: 48px; opacity: .8; }
.file .meta { min-height: 44px; }
.file .meta .name { display:flex; align-items:center; gap:8px; }
.file .meta .name strong { overflow:hidden; text-overflow:ellipsis; white-space:nowrap; display:block; }
.file .meta .sub { opacity: .85; display:flex; gap:6px; flex-wrap: wrap; }
.file .actions { display:flex; flex-wrap: wrap; gap:6px; }
.btn.sm { padding: 4px 8px; font-size: .9em; }

/* List view */
.list-files { margin-top: 12px; padding: 6px; }
.lhead, .lrow {
  display: grid;
  grid-template-columns: minmax(280px, 2fr) 110px 120px minmax(160px, 2fr) 260px;
  gap: 8px;
  align-items: center;
}
.lhead { font-weight: 700; opacity: .9; padding: 8px 6px; border-bottom: 1px solid var(--border); }
.lbody .lrow { padding: 8px 6px; border-bottom: 1px solid rgba(255,255,255,.08); border-radius: 8px; }
.lrow.sel { outline: 2px solid var(--primary); outline-offset: 0; }
.cell.name { display:flex; align-items:center; gap:10px; min-width: 0; }
.cell.name .icon { opacity: .85; }
.cell.name .linklike { color: var(--fg); background:none; border:none; padding:0; text-align:left; cursor:pointer; font-weight:600; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }
.cell.size, .cell.date, .cell.path { opacity:.9; }
.cell.actions { display:flex; flex-wrap:wrap; gap:6px; justify-content:flex-end; }
.btn.xs { padding: 3px 8px; font-size:.85em; }

/* Dropzone overlay */
.dz-overlay { position: absolute; inset: 0; display: grid; place-items: center; pointer-events: none; opacity: 0; transform: scale(.98); transition: .15s ease; }
.dz-overlay.show { opacity: 1; transform: scale(1); }
.dz-box { background: rgba(20,25,45,.7); border: 1px solid var(--border); border-radius: 14px; padding: 16px 20px; backdrop-filter: blur(4px); text-align: center; }
.dz-title { font-size: 1.1rem; font-weight: 700; }
.dz-sub { margin-top: 4px; opacity: .9; }

/* Modal viewer improvements */
.modal-backdrop { position: fixed; inset: 0; background: rgba(0,0,0,.55); display: grid; place-items: center; z-index: 50; }
.modal.viewer { background: var(--card); border:1px solid var(--border); border-radius:14px; max-width: min(94vw, 1100px); width: 100%; height: min(88vh, 860px); overflow: hidden; display: grid; grid-template-rows: auto 1fr; box-shadow: 0 20px 60px rgba(0,0,0,.35); }
.viewer-head { display:flex; align-items:center; justify-content: space-between; gap: 10px; padding: 10px 12px; border-bottom: 1px solid var(--border); }
.vh-left{ display:flex; align-items:center; gap:8px; min-width: 0; }
.vh-name{ max-width: 40vw; overflow:hidden; text-overflow: ellipsis; white-space: nowrap; }
.vh-chip{ font-size:.9em; padding:2px 6px; border:1px solid var(--border); border-radius: 999px; }
.vh-sub{ opacity:.85; }
.vh-actions{ display:flex; align-items:center; gap:6px; flex-wrap: wrap; }

.viewer-scroller{ background: #0b1020; height: 100%; overflow: auto; display: flex; align-items: center; justify-content: center; padding: 8px; }
.viewer-img{ max-width: 100%; max-height: 100%; object-fit: contain; display:block; transition: transform .06s linear; }

.other-preview{ display:grid; place-items:center; gap:10px; height:100%; }

/* Misc */
.empty { opacity:.7; text-align:center; padding: 22px; }

/* ===== Mobile-first Verbesserungen für Docs ===== */

/* Grid/Layout base */
.docs-layout {
  display: grid;
  grid-template-columns: 320px 1fr;
  gap: 16px;
}
.card { background: var(--card); border: 1px solid var(--border); border-radius: 14px; box-shadow: 0 6px 20px rgba(0,0,0,.15); }
.main { position: relative; padding-bottom: 8px; }
.main-head { display:flex; justify-content:space-between; align-items:center; gap:12px; padding: 6px; flex-wrap: wrap; }
.path { display:flex; align-items:center; gap:8px; }
.filters { display:flex; align-items:center; gap:10px; flex-wrap: wrap; }
.toggle-all { display:flex; align-items:center; gap:8px; }

/* Sidebar & Drawer (mobile) */
.sidebar { position: sticky; top: 0; height: fit-content; align-self: start; }
.drawer { position: relative; transform: none; transition: transform .2s ease; }
.drawer-backdrop { display: none; }
.show-mobile { display: none !important; }
.hide-mobile { display: initial !important; }

/* Dropzone */
.dropzone{ transition: background .15s ease, outline-color .15s ease; min-height: 180px; }
.dropzone.over{ outline:2px dashed var(--primary); outline-offset:6px; background: rgba(239,68,68,0.06); }

.dz-overlay {
  position: absolute; inset: 0; display: grid; place-items: center;
  pointer-events: none; opacity: 0; transform: scale(.98);
  transition: .15s ease;
}
.dz-overlay.show { opacity: 1; transform: scale(1); }
.dz-box {
  background: rgba(20,25,45,.7);
  border: 1px solid var(--border);
  border-radius: 14px;
  padding: 16px 20px;
  backdrop-filter: blur(4px);
  text-align: center;
}
.dz-title { font-size: 1.1rem; font-weight: 700; }
.dz-sub { margin-top: 4px; opacity: .9; }

/* Toolbar */
.toolbar { margin: 8px 6px 0; display:flex; align-items:center; gap:8px; }
.toolbar .spacer { flex:1; }

/* Grid view */
.grid-files { margin-top: 12px; display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 12px; padding: 6px; }
.file { border: 1px solid var(--border); border-radius: 12px; padding: 10px; display: grid; grid-template-rows: auto auto auto; gap: 8px; background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.05)); overflow: hidden; }
.file.sel { outline: 2px solid var(--primary); outline-offset: 0; }
.file .thumb { background: #0b1228; border-radius: 10px; aspect-ratio: 4 / 3; height: auto; display: grid; place-items: center; overflow: hidden; }
.file .thumb img { width: 100%; height: 100%; object-fit: contain; } /* Breite Bilder laufen nicht mehr raus */
.file .thumb .icon { font-size: 48px; opacity: .8; }
.file .meta { min-height: 44px; }
.file .meta .name { display:flex; align-items:center; gap:8px; }
.file .meta .name strong { overflow:hidden; text-overflow:ellipsis; white-space:nowrap; display:block; }
.file .meta .sub { opacity: .85; display:flex; gap:6px; flex-wrap: wrap; }
.file .actions { display:flex; flex-wrap: wrap; gap:6px; }
.btn.sm { padding: 4px 8px; font-size: .9em; }

/* List view (Desktop) */
.list-files { margin-top: 12px; padding: 6px; }
.lhead, .lrow {
  display: grid;
  grid-template-columns: minmax(280px, 2fr) 110px 120px minmax(160px, 2fr) 260px;
  gap: 8px;
  align-items: center;
}
.lhead { font-weight: 700; opacity: .9; padding: 8px 6px; border-bottom: 1px solid var(--border); }
.lbody .lrow { padding: 8px 6px; border-bottom: 1px solid rgba(255,255,255,.08); border-radius: 8px; }
.lrow.sel { outline: 2px solid var(--primary); outline-offset: 0; }
.cell.name { display:flex; align-items:center; gap:10px; min-width: 0; }
.cell.name .icon { opacity: .85; }
.cell.name .linklike { color: var(--fg); background:none; border:none; padding:0; text-align:left; cursor:pointer; font-weight:600; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }
.cell.size, .cell.date, .cell.path { opacity:.9; }
.cell.actions { display:flex; flex-wrap:wrap; gap:6px; justify-content:flex-end; }
.btn.xs { padding: 3px 8px; font-size:.85em; }

/* Viewer */
.modal-backdrop { position: fixed; inset: 0; background: rgba(0,0,0,.55); display: grid; place-items: center; z-index: 50; }
.modal.viewer { background: var(--card); border:1px solid var(--border); border-radius:14px; max-width: min(94vw, 1100px); width: 100%; height: min(88vh, 860px); overflow: hidden; display: grid; grid-template-rows: auto 1fr; box-shadow: 0 20px 60px rgba(0,0,0,.35); }
.viewer-head { display:flex; align-items:center; justify-content: space-between; gap: 10px; padding: 10px 12px; border-bottom: 1px solid var(--border); }
.vh-left{ display:flex; align-items:center; gap:8px; min-width: 0; }
.vh-name{ max-width: 40vw; overflow:hidden; text-overflow: ellipsis; white-space: nowrap; }
.vh-chip{ font-size:.9em; padding:2px 6px; border:1px solid var(--border); border-radius: 999px; }
.vh-sub{ opacity:.85; }
.vh-actions{ display:flex; align-items:center; gap:6px; flex-wrap: wrap; }

.viewer-scroller{ background: #0b1020; height: 100%; overflow: auto; display: flex; align-items: center; justify-content: center; padding: 8px; }
.viewer-img{ max-width: 100%; max-height: 100%; object-fit: contain; display:block; transition: transform .06s linear; }

.other-preview{ display:grid; place-items:center; gap:10px; height:100%; }

/* Toast */
.toast { position: sticky; top: -8px; margin: 0 6px 8px; background: #11233a; border: 1px solid var(--border); border-radius: 8px; padding: 8px 10px; font-weight: 600; }

/* FAB (mobile) */
.fab {
  position: fixed; right: 16px; bottom: 84px;
  width: 52px; height: 52px; border-radius: 50%;
  background: var(--primary); color: #fff; border: none; font-size: 26px;
  box-shadow: 0 6px 20px rgba(0,0,0,.35); cursor: pointer;
}

/* Bottom action bar (mobile) */
.bottom-bar {
  position: fixed; left: 0; right: 0; bottom: 0; z-index: 40;
  display: none; align-items: center; gap: 8px;
  padding: 10px; background: rgba(17, 34, 58, .96); border-top: 1px solid var(--border);
}
.bottom-bar.show { display: flex; }
.bb-count { font-weight: 700; margin-right: auto; }

/* Breakpoints */
@media (max-width: 920px) {
  .docs-layout { grid-template-columns: 1fr; }
  .hide-mobile { display: none !important; }
  .show-mobile { display: inline-flex !important; }

  /* Sidebar as drawer */
  .drawer {
    position: fixed; inset: 0 auto 0 0; width: min(86vw, 360px); max-width: 90vw;
    transform: translateX(-100%); z-index: 60; height: 100vh; overflow: auto;
  }
  .drawer.open { transform: translateX(0); }
  .drawer-backdrop { display: block; position: fixed; inset: 0; background: rgba(0,0,0,.5); z-index: 55; opacity: 0; pointer-events: none; transition: opacity .2s ease; }
  .drawer-backdrop.open { opacity: 1; pointer-events: all; }

  /* Grid tighter on small screens */
  .grid-files { grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); }
  .file .thumb .icon { font-size: 42px; }
  .viewer-head .vh-name { max-width: 52vw; }

  /* List view stacked */
  .lhead { display: none; }
  .lrow {
    grid-template-columns: 1fr;
    gap: 6px; padding: 10px; border: 1px solid var(--border); border-radius: 10px; margin-bottom: 8px;
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.05));
  }
  .lrow .cell { display: flex; align-items: center; gap: 8px; }
  .lrow .cell.path { opacity: .85; }
  .cell.actions { justify-content: flex-start; }
  .btn.xs { padding: 6px 10px; font-size: .95em; }
  
  /* Viewer full-screen */
  .modal.viewer { width: 100vw; height: 100vh; border-radius: 0; max-width: 100vw; }
}

/* Accessibility helper */
.screen-reader { position:absolute; left:-9999px; top:auto; width:1px; height:1px; overflow:hidden; }
.empty { opacity:.7; text-align:center; padding: 22px; }
